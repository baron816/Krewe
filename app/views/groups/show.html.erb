<div class="row group-page">
	<div class="col s12">
		<h3>
			<%= @group_show.group_name %>
		</h3>
		<div class="hide-on-med-and-down">
			<%= render "groups/buttons" %>

			<%= link_to "Propose Activity", new_group_activity_path(@group_show.group), id: 'new_activity', class: 'waves-effect waves-light btn purple', remote: true %>
		</div>
	</div>

	<div class="col s12 m9">
		<h4>Messages</h4>
			<div class="col s12">
				<ul class="tabs topics">
					<%= render partial: 'topics/topics', locals: { topics: @group_show.topics } %>
				</ul>
			</div>

			<%= render partial: 'topics/new', locals: { group: @group_show.group, topic: @group_show.new_topic } %>

		<div class="message-group">
			<%= render partial: 'topics/topic', locals: { topic: @group_show.topic } %>
		</div>
	</div>

	<div class="col s12 m3">
		<h4>Activities</h4>
		<% if @group_show.activities_any? %>
					<% @group_show.activities.each do |activity| %>
					<div class="card">
						<div class="card-content">
							<span class="card-title"><%= link_to activity.plan, activity_path(activity) %></span>
							<p>
								<%= activity.location %>
								<%= local_time(activity.appointment) %>
							</p>
						</div>
						<% unless activity.user_going?(current_user) %>
							<div class="card-action">
								<%= link_to "Go", add_user_activity_path(activity), method: :post %>
							</div>
						<% end %>
					</div>
					<% end %>
		<% else %>
			<div class="card">
				<div class="card-content">
					<span class="card-title black-text">No Upcoming Activities</span>
					<p>
						<%= link_to "Propose one...", new_group_activity_path(@group_show.group), remote: true %>
					</p>
				</div>
			</div>
		<% end %>
	</div>

	<div id='new-activity' class="modal"></div>

	<div class="modal" id="members">
		<div class="modal-content">
			<h4>Members</h4>
			<ul class="collection">
				<% if @group_show.one_user? %>
					<li class="collection-item">No other users in the group yet. We'll let you know when they join.</li>
				<% end %>
				<% @group_show.users.each do |user| %>
					<li class="collection-item avatar">
						<i class="material-icons circle green">face</i>
						<span class="title"><%= link_to user.name, public_profile_user_path(user) %></span>
						 <% if @group_show.primary_group? %>
							 	<% if current_user.can_vote?(user) %>
							 		<%= link_to "<i class='material-icons'>cancel</i> #{user.group_drop_votes_count(@group_show.group)}/3".html_safe, group_drop_user_votes_path(@group_show.group, user_id: user), remote: true, method: :post, class: 'btn red secondary-content', id: "remove-btn-#{user.id}", data: {confirm: "Vote to remove this user?", text: "Remove inactive users, but only if they're inactive."} %>
							 	<% elsif user.not_self(current_user) %>
							 		<%= link_to "Undo #{user.group_drop_votes_count(@group_show.group)}/3", group_drop_user_vote_path(@group_show.group, user.voter_vote(current_user)), remote: true, method: :delete, class: 'btn orange secondary-content', id: "undo-btn-#{user.id}" %>
							 	<% end %>
						 <% end %>
					 	</li>
				<% end %>
			</ul>
		</div>
	</div>


</div>

<%= javascript_tag do %>
	mentioning(<%= @group_show.names_data(current_user) %>)
<% end %>
