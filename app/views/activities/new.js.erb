$('#new_activity').hide().after('<%= j render("new") %>')
$('#datetimepicker').datetimepicker({
	format: 'YYYY-MM-DD hh:mm A',
	minDate: new Date()
});



function initialize() {
	var mapOptions = {
		center: new google.maps.LatLng('<%= current_user.latitude %>', '<%= current_user.longitude %>'),
		zoom: 13
	};

	var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

	var input = document.getElementById('activity_location');

	var autocomplete = new google.maps.places.Autocomplete(input);
	var marker = new google.maps.Marker({
		map: map,
		anchorPoint: new google.maps.Point(0,-29)
	})

	google.maps.event.addListener(autocomplete, 'place_changed', function () {
		var place = autocomplete.getPlace();
		marker.setVisible(false);

		if (!place.geometry) {
			console.log("No geometry")
			return
		}

		if (place.geometry.viewport) {
			map.fitBounds(place.geometry.viewport)
		} else {
			map.setCenter(place.geometry.location);
			map.setZoom(17);
		}

		marker.setIcon(/** @type {google.maps.Icon} */({
			url: place.icon,
			size: new google.maps.Size(71, 71),
      origin: new google.maps.Point(0, 0),
      anchor: new google.maps.Point(17, 34),
      scaledSize: new google.maps.Size(35, 35)
		}));
		marker.setPosition(place.geometry.location);
		marker.setVisible(true);
		$('#activity_latitude').val(place.geometry.location.lat());
		$('#activity_longitude').val(place.geometry.location.lng());
	})
}

initialize()
