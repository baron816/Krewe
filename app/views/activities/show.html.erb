<div class="well">
	<h1><%= @activity.plan %></h1>
	<% if @activity.user_going?(current_user) %>
		<%= link_to "Can't go", remove_user_group_activity_path(@activity.group, @activity.activity), method: :delete, class: 'btn btn-danger' %>
	<% else %>
		<%= link_to "Go", add_user_group_activity_path(@activity.group, @activity.activity), remote: true, method: :post, class: 'btn btn-success', id: "activity-go" %>
	<% end %>
	<h1><%= link_to @activity.group_name, @activity.group %></h1>
	<h2><%= local_time(@activity.appointment) %></h2>
	<h2><%= @activity.location %></h2>

	<div id="map">

	</div>
	<%= link_to "Edit Activity", edit_group_activity_path(@activity.group, @activity.activity), class: 'btn btn-warning' if @activity.proposed_by?(current_user) %>
</div>

<div class="col-md-6">
	<h3>People going</h3>
		<ul class="list-group">
		<% @activity.users.each do |user| %>
			<li class="list-group-item"><%= link_to user.name, public_profile_user_path(user) %></li>
		<% end %>
		</ul>
</div>

<div class="col-md-6">
	<h3>Messages</h3>
	<div class="messages well">
		<% @activity.messages.each do |message| %>
		  <%= render partial: 'messages/show', locals: {message: message} %>
		<% end %>
	</div>

	<%= render partial: 'messages/new', locals: {message: @activity.new_message} %>
</div>

<script>
	handler = Gmaps.build('Google');
	handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
	markers = handler.addMarkers([
		{
			"lat": <%= @activity.latitude %>,
			"lng": <%= @activity.longitude %>
		}
	]);
	handler.bounds.extendWith(markers);
	handler.fitMapToBounds();
	handler.getMap().setZoom(17);
	});
</script>
